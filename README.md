# 基于 Transformer 和 LLM 的智能书籍推荐系统

这是一个利用 Transformer 和大语言模型（LLM）技术构建的智能书籍推荐系统，结合向量搜索、文本分类和语义情感分析，为用户提供个性化的书籍推荐体验。系统通过直观的 Gradio 界面实现交互式查询、分类筛选和情感基调过滤功能。

## 项目概述

本项目基于 Kaggle 的 7k Books 数据集，结合先进的 NLP 技术和向量数据库，实现了高效的书籍推荐功能。系统通过嵌入书籍描述、分类文本内容、分析情感基调，并提供用户友好的可视化界面，为用户推荐符合其偏好的书籍。

## 数据收集与清洗

- **数据集**：使用 Kaggle 上的 7k Books 数据集，包含丰富的书籍元数据（如标题、作者、描述等）。
- **数据清洗**：
  - 使用 Spearman 相关性矩阵分析标签缺失情况，识别数据完整性问题。
  - 删除缺失 `description` 字段的数据，确保推荐系统的输入质量。

## 功能模块

### 1. 向量搜索推荐

- **技术栈**：采用 Chroma 向量数据库存储书籍描述的语义嵌入。
- **嵌入模型**：使用 Qwen 的 `text-embedding-v2` 模型将书籍描述转化为高维向量。
- **推荐逻辑**：通过查询与书籍描述向量的余弦相似度比较，实现高效的语义搜索推荐。

### 2. 文本分类

- **模型**：基于 Hugging Face 上 Meta 开源的 `bart-large-mnli` 模型。
- **方法**：采用 Zero-Shot Classification 技术，将书籍描述分类为“虚构”或“非虚构”类别。
- **应用**：支持用户根据书籍类型筛选推荐结果。

### 3. 语义情感分析

- **模型**：使用微调过的 `bart-large-mnli` 模型（准确率约为 66%）。
- **流程**：
  - 将书籍描述分句，分别进行情感分析。
  - 汇总每段描述的情感得分，保留每种情感类型（如快乐、悬疑、难过等）的最高分。
- **功能**：支持用户基于情感基调（如“快乐”或“悬疑”）筛选书籍。

### 4. Gradio 数据可视化

- **界面设计**：基于 Gradio 框架开发用户友好的交互式 UI。
- **功能**：
  - **查询输入**：用户可输入文本描述偏好（如“跌宕起伏的冒险故事”）。
  - **分类筛选**：支持按书籍类型（虚构/非虚构）或情感基调过滤。
  - **推荐展示**：以图文并茂的画廊形式展示推荐书籍，包括封面、标题、作者和描述。
- **体验优化**：界面美观，响应迅速，支持动态加载动画。